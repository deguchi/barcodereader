<!DOCTYPE html><html lang="ja"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=640, initial-scale=1.0,user-scalable=no"> <meta http-equiv="X-UA-Compatible" content="ie=edge"> <title>バーコードリーダーサンプル</title> <style>body,html{padding:0;margin:0;background:#000}#camera canvas{position:absolute;top:0;left:0}#cover{display:none}</style> </head> <body> <div id="camera"></div> <script src="https://serratus.github.io/quaggaJS/examples/js/quagga.min.js" type="text/javascript"></script> <script>function e(e){var a=[];a=(e+="").substr(3,9).split("");for(var t,n,o=0,r=0;r<9;r++)o+=a[r]*(10-r);return n=10==(t=11-o%11)?"X":11==t?0:t,a.push(n),a.join("")}Quagga.init({numOfWorkers:4,frequency:10,locate:!0,inputStream:{name:"Live",type:"LiveStream",target:document.querySelector("#camera"),constraints:{width:{min:640,ideal:window.innerWidth,max:1920},height:{min:480,ideal:window.innerHeight,max:1080},facingMode:"environment",frameRate:10}},decoder:{readers:["ean_reader"]},locator:{patchSize:"medium"}},function(e){e?console.log(e):(console.log("Initialization finished. Ready to start"),Quagga.start())}),Quagga.onProcessed(function(e){var a=Quagga.canvas.ctx.overlay,t=Quagga.canvas.dom.overlay;e&&(e.boxes&&(a.clearRect(0,0,parseInt(t.getAttribute("width")),parseInt(t.getAttribute("height"))),e.boxes.filter(function(a){return a!==e.box}).forEach(function(e){Quagga.ImageDebug.drawPath(e,{x:0,y:1},a,{color:"green",lineWidth:2})})),e.box&&Quagga.ImageDebug.drawPath(e.box,{x:0,y:1},a,{color:"#00F",lineWidth:2}),e.codeResult&&e.codeResult.code&&Quagga.ImageDebug.drawPath(e.line,{x:"x",y:"y"},a,{color:"red",lineWidth:3}))});var a=!1,t=n();function n(){if(""===location.search)return null;var e={};return location.search.substr(1).split("&").map(function(a){var t=a.split("=");e[t[0]]=decodeURIComponent(t[1])}),e}Quagga.onDetected(function(n){var o=n.codeResult.code;a||o.match(/^19/)||(a=!0,console.log(t),t?("10"===t.isbn&&o.match(/^97[8|9]/)&&(o=e(o)),setTimeout(function(){location.href=t.url.replace("{{barcode}}",o)},300)):alert(o))});</script> </body> </html>